import{j as e,P as c,u as f,t as R,q as v,fL as w,fM as C,w as h,fN as x,b as g,$ as P,W as F,a2 as A,F as I,T as L,U as p,aj as E,X as d,ak as D,al as N,aN as U}from"./strapi-DJtumbce.js";import{u as m}from"./hooks-CFk_8Q0b-BNSIeCI6.js";import{S as B}from"./schemas-DMt8h1z--BIG6YDxM.js";import"./index-Ba92iSq3.js";const H=()=>{const{formatMessage:s}=f(),{formatAPIError:r}=R(),{toggleNotification:n}=v(),{data:u,isLoading:a}=w(),[t,{isLoading:j}]=C(),S=m(i=>i.admin_app.permissions.settings?.releases),{allowedActions:{canUpdate:T}}=h(S),{timezoneList:y}=x(new Date),z=async i=>{const{defaultTimezone:l}=i,b=y.some(o=>o.value===l),M=!l||!b?{defaultTimezone:null}:{...i};try{const o=await t(M);"data"in o?n({type:"success",message:s({id:"content-releases.pages.Settings.releases.setting.default-timezone-notification-success",defaultMessage:"Default timezone updated."})}):U(o.error)?n({type:"danger",message:r(o.error)}):n({type:"danger",message:s({id:"notification.error",defaultMessage:"An error occurred"})})}catch{n({type:"danger",message:s({id:"notification.error",defaultMessage:"An error occurred"})})}};return a?e.jsx(c.Loading,{}):e.jsxs(g.Root,{children:[e.jsx(c.Title,{children:s({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:"Releases"})}),e.jsx(c.Main,{"aria-busy":a,tabIndex:-1,children:e.jsx(P,{method:"PUT",initialValues:{defaultTimezone:u?.data.defaultTimezone},onSubmit:z,validationSchema:B,children:({modified:i,isSubmitting:l})=>e.jsxs(e.Fragment,{children:[e.jsx(g.Header,{primaryAction:T?e.jsx(F,{disabled:!i||j,loading:l,startIcon:e.jsx(A,{}),type:"submit",children:s({id:"global.save",defaultMessage:"Save"})}):null,title:s({id:"content-releases.pages.Settings.releases.title",defaultMessage:"Releases"}),subtitle:s({id:"content-releases.pages.Settings.releases.description",defaultMessage:"Create and manage content updates"})}),e.jsx(g.Content,{children:e.jsxs(I,{direction:"column",background:"neutral0",alignItems:"stretch",padding:6,gap:6,shadow:"filterShadow",hasRadius:!0,children:[e.jsx(L,{variant:"delta",tag:"h2",children:s({id:"content-releases.pages.Settings.releases.preferences.title",defaultMessage:"Preferences"})}),e.jsx(p.Root,{children:e.jsx(p.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:e.jsx(_,{})})})]})})]})})})]})},_=()=>{const s=m(t=>t.admin_app.permissions.settings?.releases),{allowedActions:{canUpdate:r}}=h(s),{formatMessage:n}=f(),{timezoneList:u}=x(new Date),a=E("defaultTimezone");return e.jsxs(d.Root,{name:"defaultTimezone",hint:n({id:"content-releases.pages.Settings.releases.timezone.hint",defaultMessage:"The timezone of every release can still be changed individually. "}),error:a.error,children:[e.jsx(d.Label,{children:n({id:"content-releases.pages.Settings.releases.timezone.label",defaultMessage:"Default timezone"})}),e.jsx(D,{autocomplete:{type:"list",filter:"contains"},onChange:t=>a.onChange("defaultTimezone",t),onTextValueChange:t=>a.onChange("defaultTimezone",t),onClear:()=>a.onChange("defaultTimezone",""),value:a.value,disabled:!r,children:u.map(t=>e.jsx(N,{value:t.value,children:t.value.replace(/&/," ")},t.value))}),e.jsx(d.Hint,{}),e.jsx(d.Error,{})]})},q=()=>{const s=m(r=>r.admin_app.permissions.settings?.releases?.read);return e.jsx(c.Protect,{permissions:s,children:e.jsx(H,{})})};export{q as ProtectedReleasesSettingsPage};
