const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["MagicLinkEE-DTAON-gr-CF7W25iw.js","strapi-DJtumbce.js","strapi-B5podyrr.css","SelectRoles-BeTlhnbV-C6LodXfS.js","useAdminRoles-BQUZxCqP-m8VeDhZN.js","CreateActionEE-DZ6ApqOF-H3MNxcqW.js","isNil-ClCEAGdJ.js","ListPage-DZl2fbSD-DI4gzE68.js","useLicenseLimitNotification-C5v7Ol_s-CCLL7kNg.js","users-B3iOAYG--MOwOr-tf.js"])))=>i.map(i=>d[i]);
import{g as re,l as q,k as x,am as ne,aa as Q,j as e,P as R,aX as E,aY as M,t as W,r as g,w as ie,a5 as le,q as J,u as H,aZ as oe,ah as de,a_ as ce,a$ as ue,b as B,aG as me,ac as I,ad as o,T as A,F as w,I as $,aE as ge,H as pe,aJ as he,af as N,aK as fe,aL as xe,b0 as be,W as P,b1 as je,b2 as Ee,M as b,N as Me,O as Ae,$ as ye,B as T,U as j,a0 as Y,ar as Le}from"./strapi-DJtumbce.js";import{g as G}from"./users-B3iOAYG--MOwOr-tf.js";import{M as _e,S as Se}from"./SelectRoles-BeTlhnbV-C6LodXfS.js";import"./useAdminRoles-BQUZxCqP-m8VeDhZN.js";const Ce=g.forwardRef((a,l)=>{const{formatMessage:p}=H();return e.jsx(P,{ref:l,startIcon:e.jsx(je,{}),size:"S",...a,children:p({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"})})}),Ie=({onToggle:a})=>{const[l,p]=g.useState("create"),[k,v]=g.useState(""),{formatMessage:r}=H(),{toggleNotification:m}=J(),{_unstableFormatAPIError:F,_unstableFormatValidationErrors:y}=W(),c=E(Te,async()=>(await M(async()=>{const{ROLE_LAYOUT:t}=await import("./ModalForm-CZ98aSC9-CamjQBT3.js");return{ROLE_LAYOUT:t}},[])).ROLE_LAYOUT,{combine(t,d){return[...t,...d]},defaultValue:[]}),U=E(K,async()=>(await M(async()=>{const{FORM_INITIAL_VALUES:t}=await import("./ModalForm-CZ98aSC9-CamjQBT3.js");return{FORM_INITIAL_VALUES:t}},[])).FORM_INITIAL_VALUES,{combine(t,d){return{...t,...d}},defaultValue:K}),L=E(_e,async()=>(await M(async()=>{const{MagicLinkEE:t}=await import("./MagicLinkEE-DTAON-gr-CF7W25iw.js");return{MagicLinkEE:t}},__vite__mapDeps([0,1,2,3,4]))).MagicLinkEE),[h]=Ee(),_=r({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}),O=async(t,{setErrors:d})=>{const n=await h({...t,roles:t.roles??[]});"data"in n?(n.data.registrationToken&&v(n.data.registrationToken),D()):(m({type:"danger",message:F(n.error)}),Le(n.error)&&n.error.name==="ValidationError"&&d(y(n.error)))},D=()=>{C?p(C):a()},{buttonSubmitLabel:S,isDisabled:f,next:C}=we[l];return L?e.jsx(b.Root,{defaultOpen:!0,onOpenChange:a,children:e.jsxs(b.Content,{children:[e.jsx(b.Header,{children:e.jsx(Me,{label:_,children:e.jsx(Ae,{isCurrent:!0,children:_})})}),e.jsx(ye,{method:l==="create"?"POST":"PUT",initialValues:U??{},onSubmit:O,validationSchema:Pe,children:({isSubmitting:t})=>e.jsxs(e.Fragment,{children:[e.jsx(b.Body,{children:e.jsxs(w,{direction:"column",alignItems:"stretch",gap:6,children:[l!=="create"&&e.jsx(L,{registrationToken:k}),e.jsxs(T,{children:[e.jsx(A,{variant:"beta",tag:"h2",children:r({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"User details"})}),e.jsx(T,{paddingTop:4,children:e.jsx(w,{direction:"column",alignItems:"stretch",gap:1,children:e.jsx(j.Root,{gap:5,children:Re.map(d=>d.map(({size:n,...i})=>e.jsx(j.Item,{col:n,direction:"column",alignItems:"stretch",children:e.jsx(Y,{...i,disabled:f,label:r(i.label),placeholder:r(i.placeholder)})},i.name)))})})})]}),e.jsxs(T,{children:[e.jsx(A,{variant:"beta",tag:"h2",children:r({id:"global.roles",defaultMessage:"User's role"})}),e.jsx(T,{paddingTop:4,children:e.jsxs(j.Root,{gap:5,children:[e.jsx(j.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:e.jsx(Se,{disabled:f})}),c.map(d=>d.map(({size:n,...i})=>e.jsx(j.Item,{col:n,direction:"column",alignItems:"stretch",children:e.jsx(Y,{...i,disabled:f,label:r(i.label),placeholder:i.placeholder?r(i.placeholder):void 0,hint:i.hint?r(i.hint):void 0})},i.name)))]})})]})]})}),e.jsxs(b.Footer,{children:[e.jsx(P,{variant:"tertiary",onClick:a,type:"button",children:r({id:"app.components.Button.cancel",defaultMessage:"Cancel"})}),l==="create"?e.jsx(P,{type:"submit",loading:t,children:r(S)}):e.jsx(P,{type:"button",loading:t,onClick:a,children:r(S)})]})]})})]})}):null},K={firstname:"",lastname:"",email:"",roles:[]},Te=[],Re=[[{label:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"string",size:6,required:!0},{label:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"string",size:6}],[{label:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:6,required:!0}]],Pe=re().shape({firstname:q().trim().required({id:x.required.id,defaultMessage:"This field is required"}).nullable(),lastname:q(),email:q().email(x.email).required({id:x.required.id,defaultMessage:"This field is required"}).nullable(),roles:ne().min(1,{id:x.required.id,defaultMessage:"This field is required"}).required({id:x.required.id,defaultMessage:"This field is required"})}),we={create:{buttonSubmitLabel:{id:"app.containers.Users.ModalForm.footer.button-success",defaultMessage:"Invite user"},isDisabled:!1,next:"magic-link"},"magic-link":{buttonSubmitLabel:{id:"global.finish",defaultMessage:"Finish"},isDisabled:!0,next:null}},ke=()=>{const{_unstableFormatAPIError:a}=W(),[l,p]=g.useState(!1),k=Q(s=>s.admin_app.permissions),{allowedActions:{canCreate:v,canDelete:r,canRead:m}}=ie(k.settings?.users),F=le(),{toggleNotification:y}=J(),{formatMessage:c}=H(),{search:U}=oe(),[L,h]=g.useState(!1),[_,O]=g.useState([]),{data:D,isError:S,isLoading:f}=de(ce.parse(U,{ignoreQueryPrefix:!0})),{pagination:C,users:t=[]}=D??{},d=E(Ce,async()=>(await M(async()=>{const{CreateActionEE:s}=await import("./CreateActionEE-DZ6ApqOF-H3MNxcqW.js");return{CreateActionEE:s}},__vite__mapDeps([5,1,2,6]))).CreateActionEE),n=ve.map(s=>({...s,label:c(s.label)})),i=c({id:"global.users",defaultMessage:"Users"}),z=()=>{p(s=>!s)},[X]=ue(),Z=async s=>{try{const u=await X({ids:s});"error"in u&&y({type:"danger",message:a(u.error)})}catch{y({type:"danger",message:c({id:"global.error",defaultMessage:"An error occurred"})})}},ee=s=>()=>{m&&F(s.toString())},se=s=>async()=>{O([s]),h(!0)},ae=async()=>{await Z(_),h(!1)};return d?S?e.jsx(R.Error,{}):e.jsxs(R.Main,{"aria-busy":f,children:[e.jsx(R.Title,{children:c({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:"Users"})}),e.jsx(B.Header,{primaryAction:v&&e.jsx(d,{onClick:z}),title:i,subtitle:c({id:"Settings.permissions.users.listview.header.subtitle",defaultMessage:"All the users who have access to the Strapi admin panel"})}),e.jsx(B.Action,{startActions:e.jsxs(e.Fragment,{children:[e.jsx(me,{label:c({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:i})}),e.jsxs(I.Root,{options:Fe,children:[e.jsx(I.Trigger,{}),e.jsx(I.Popover,{}),e.jsx(I.List,{})]})]})}),e.jsxs(B.Content,{children:[e.jsxs(o.Root,{rows:t,headers:n,children:[e.jsx(o.ActionBar,{}),e.jsxs(o.Content,{children:[e.jsxs(o.Head,{children:[r?e.jsx(o.HeaderCheckboxCell,{}):null,n.map(s=>e.jsx(o.HeaderCell,{...s},s.name))]}),e.jsx(o.Empty,{}),e.jsx(o.Loading,{}),e.jsx(o.Body,{children:t.map(s=>e.jsxs(o.Row,{onClick:ee(s.id),cursor:m?"pointer":"default",children:[r?e.jsx(o.CheckboxCell,{id:s.id}):null,n.map(({cellFormatter:u,name:V,...te})=>e.jsx(o.Cell,{children:typeof u=="function"?u(s,{name:V,...te}):e.jsx(A,{textColor:"neutral800",children:s[V]||"-"})},V)),m||r?e.jsx(o.Cell,{onClick:u=>u.stopPropagation(),children:e.jsxs(w,{justifyContent:"end",children:[m?e.jsx($,{tag:ge,to:s.id.toString(),label:c({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:G(s)}),variant:"ghost",children:e.jsx(pe,{})}):null,r?e.jsx($,{onClick:se(s.id),label:c({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:G(s)}),variant:"ghost",children:e.jsx(he,{})}):null]})}):null]},s.id))})]})]}),e.jsxs(N.Root,{...C,children:[e.jsx(N.PageSize,{}),e.jsx(N.Links,{})]})]}),l&&e.jsx(Ie,{onToggle:z}),e.jsx(fe.Root,{open:L,onOpenChange:h,children:e.jsx(xe,{onConfirm:ae})})]}):null},ve=[{name:"firstname",label:{id:"Settings.permissions.users.firstname",defaultMessage:"Firstname"},sortable:!0},{name:"lastname",label:{id:"Settings.permissions.users.lastname",defaultMessage:"Lastname"},sortable:!0},{name:"email",label:{id:"Settings.permissions.users.email",defaultMessage:"Email"},sortable:!0},{name:"roles",label:{id:"Settings.permissions.users.roles",defaultMessage:"Roles"},sortable:!1,cellFormatter({roles:a}){return e.jsx(A,{textColor:"neutral800",children:a.map(l=>l.name).join(`,
`)})}},{name:"username",label:{id:"Settings.permissions.users.username",defaultMessage:"Username"},sortable:!0},{name:"isActive",label:{id:"Settings.permissions.users.user-status",defaultMessage:"User status"},sortable:!1,cellFormatter({isActive:a}){return e.jsx(w,{children:e.jsx(be,{size:"S",borderWidth:0,background:"transparent",color:"neutral800",variant:a?"success":"danger",children:e.jsx(A,{children:a?"Active":"Inactive"})})})}}],Fe=[{name:"firstname",label:"Firstname",type:"string"},{name:"lastname",label:"Lastname",type:"string"},{name:"email",label:"Email",type:"email"},{name:"username",label:"Username",type:"string"},{name:"isActive",label:"Active user",type:"boolean"}],Ue=()=>{const a=E(ke,async()=>(await M(async()=>{const{UserListPageEE:l}=await import("./ListPage-DZl2fbSD-DI4gzE68.js");return{UserListPageEE:l}},__vite__mapDeps([7,1,2,8,6,3,4,9]))).UserListPageEE);return a?e.jsx(a,{}):null},Be=()=>{const a=Q(l=>l.admin_app.permissions.settings?.users.read);return e.jsx(R.Protect,{permissions:a,children:e.jsx(Ue,{})})};export{Ue as ListPage,ke as ListPageCE,Be as ProtectedListPage};
